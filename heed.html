<div class="sheet-wrapper">
	<div class="logo">
		<img src="https://heed-ttrpg-public-6789.s3.eu-west-2.amazonaws.com/heed-transparent.png" />
	</div>
    <!-- <div class="sheet-heading"> -->
    <!-- </div> -->
    <div class="sheet-exp">
    	<span>
    		<span>Name:</span>
    		<input id="pc-name" class="sheet-wide" type="text" name="attr_character_name" value="Knave"/>
   		</span>
    	<span>
        	<span>Level:</span>
        	<input class="sheet-wide" type="number" name="attr_level" value="1" />
        </span>
        <span>
	        <span>Experience:</span>
	        <input class="sheet-wide" type="number" name="attr_exp" value="0" />
        </span>
        <span>
	        <span>Coin in stash:</span>
	        <input class="sheet-wide" type="number" name="attr_gold" value="0" />
        </span>
    </div>
    <div class="sheet-hps">
        <span>Hit Points</span>
        <span>Current:&nbsp;<input type="number" name="attr_hp" value="1"/></span>
        <span>Max HP:&nbsp;<input type="number" name="attr_hp_max" value="1"/></span>
    </div>
    <div class="sheet-defence">
        Defence
     <span class="sheet-defence1">Num armour pieces: &nbsp;<input type="number" name="attr_defence" value="0"/></span>
    </div>

    <div class="sheet-str">
        <span class="sheet-att-name">Str:&nbsp;<input type="number" name="attr_strength" value="0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled STR}} {{Strength:=[[1d8 + @{strength}]]}}' name='roll_strcheck' /></span>
    </div>
    <div class="sheet-dex">
        <span class="sheet-att-name">Dex:&nbsp;<input type="number" name="attr_dexterity" value="0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled DEX}} {{Dexterity:=[[1d8 + @{dexterity}]]}}' name='roll_dexcheck' /></span>
    </div>
        <div class="sheet-con">
        <span class="sheet-att-name">Con:&nbsp;<input type="number" name="attr_constitution" value="0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled CON}} {{Constitution:=[[1d8 + @{constitution}]]}}' name='roll_concheck' /></span>
    </div>
    <div class="sheet-int">
        <span class="sheet-att-name">Int:&nbsp;<input type="number" name="attr_intelligence" value=0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled INT}} {{Intelligence:=[[1d8 + @{intelligence}]]}}' name='roll_intcheck' /></span>
    </div>
    <div class="sheet-wis">
        <span class="sheet-att-name">Wis:&nbsp;<input type="number" name="attr_wisdom" value="0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled WIS}} {{Wisdom:=[[1d8 + @{wisdom}]]}}' name='roll_wischeck' /></span>
    </div>
    <div class="sheet-cha">
        <span class="sheet-att-name">Cha:&nbsp;<input type="number" name="attr_charisma" value="0"/></span>
        <span class="sheet-att-bon"><button type='roll' value='&{template:default} {{name=@{character_name} rolled CHA}} {{Charisma:=[[1d8 + @{charisma}]]}}' name='roll_chacheck' /></span>
    </div>

	<!-- Define hidden inputs for each weapon's dice value -->
	<input type="hidden" name="attr_attack_1_dice" value="d4">
	<input type="hidden" name="attr_attack_2_dice" value="d4">
	<input type="hidden" name="attr_attack_4_dice" value="d4">
	<input type="hidden" name="attr_attack_5_dice" value="d4">

	<input type="hidden" name="attr_Shortsword_dice" value="d4">
	<input type="hidden" name="attr_Axe_dice" value="d4">
	<input type="hidden" name="attr_Dagger_dice" value="d8">
	<input type="hidden" name="attr_Shortbow_dice" value="d4">

    <div class="sheet-attacks">
		<span>
        	&nbsp;Melee Weapon
	        <span class="sheet-attack-slot">
		        <select class="sheet-attack-descr" name="attr_attack_1_desc">
		          <option value="Shortsword">Shortsword</option>
		          <option value="Axe">Axe</option>
		          <option value="Dagger">Dagger</option>
		        </select>
		        <button type="roll" name="act_attack_1_btn" value='&{template:default} {{name=@{character_name}}} rolled an attack with Strength: {{Strength:=[[@{attack_1_dice} + @{strength} - ?{targets defence|0}]]}} {{Weapon=@{attack_1_desc}}} (WeaponIndex=1)'></button>
	        </span>
	        <span class="sheet-attack-slot">
		        <select class="sheet-attack-descr" name="attr_attack_2_desc">
		          <option value="Shortsword">Shortsword</option>
		          <option value="Axe">Axe</option>
		          <option value="Dagger">Dagger</option>
		        </select>
		        <button type="roll" name="act_attack_2_btn" value='&{template:default} {{name=@{character_name}}} rolled an attack with Strength: {{Strength:=[[@{attack_2_dice} + @{strength} - ?{targets defence|0}]]}} {{Weapon=@{attack_2_desc}}} (WeaponIndex=2)'></button>
	        </span>
        </span>
        <span>
	        <span class="sheet-top-break">&nbsp;Ranged Weapon</span>
	        <span class="sheet-attack-slot">
		        <select class="sheet-attack-descr" name="attr_attack_4_desc">
		          <option value="Shortbow">Shortbow</option>
		          <option value="Crossbow">Crossbow</option>
		        </select>
		        <button type="roll" name="act_attack_4_btn" value='&{template:default} {{name=@{character_name}}} rolled an attack with Wisdom: {{Wisdom:=[[@{attack_4_dice} + @{wisdom} - ?{targets defence|0}]]}} {{Weapon=@{attack_4_desc}}} (WeaponIndex=4)'></button>
			</span>
	        <span class="sheet-attack-slot">
		        <select class="sheet-attack-descr" name="attr_attack_5_desc">
		          <option value="Shortbow">Shortbow</option>
		          <option value="Crossbow">Crossbow</option>
		        </select>
		        <button type="roll" name="act_attack_5_btn" value='&{template:default} {{name=@{character_name}}} rolled an attack with Wisdom: {{Wisdom:=[[@{attack_5_dice} + @{wisdom} - ?{targets defence|0}]]}} {{Weapon=@{attack_5_desc}}} (WeaponIndex=5)'></button>
			</span>
		</span>
    </div>
    <div class="sheet-notes">
        Careers, Notes, etc.
        <textarea name="attr_notes"></textarea>
    </div>
    <div class="sheet-slots">
        <span class="sheet-slots-title">Equipment Slots ( Character Max Slots = <input type="number" name="attr_slots" value="10+@{constitution}" disabled="true"/> )
        </span>
        <span class="sheet-slot">
         &nbsp;1:&nbsp;<input class="sheet-contents" type="text" name="attr_item_1_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_1_qual" value=""/>
        </span>
        <span class="sheet-slot">
          11:<input class="sheet-contents"  type="text" name="attr_item_11_desc" value=""/>
           <input class="sheet-quality" type="text" name="attr_item_11_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;2:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_2_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_2_qual" value=""/>
        </span>
        <span class="sheet-slot">
         12:<input class="sheet-contents"  type="text" name="attr_item_12_desc" value=""/>
         <input class="sheet-quality" type="text" name="attr_item_12_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;3:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_3_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_3_qual" value=""/>
        </span>
        <span class="sheet-slot">
          13:<input class="sheet-contents"  type="text" name="attr_item_13_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_13_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;4:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_4_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_4_qual" value=""/>
        </span>
        <span class="sheet-slot">
          14:<input class="sheet-contents"  type="text" name="attr_item_14_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_14_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;5:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_5_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_5_qual" value=""/>
        </span>
        <span class="sheet-slot">
          15:<input class="sheet-contents"  type="text" name="attr_item_15_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_15_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;6:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_6_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_6_qual" value=""/>
        </span>
        <span class="sheet-slot">
          16:<input class="sheet-contents"  type="text" name="attr_item_16_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_16_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;7:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_7_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_7_qual" value=""/>
        </span>
        <span class="sheet-slot">
          17:<input class="sheet-contents"  type="text" name="attr_item_17_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_17_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;8:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_8_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_8_qual" value=""/>
        </span>
        <span class="sheet-slot">
          18:<input class="sheet-contents"  type="text" name="attr_item_18_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_18_qual" value=""/>
        </span>
        <span class="sheet-slot">
          &nbsp;9:&nbsp;<input class="sheet-contents"  type="text" name="attr_item_9_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_9_qual" value=""/>
        </span>
        <span class="sheet-slot">
          19:<input class="sheet-contents"  type="text" name="attr_item_19_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_19_qual" value=""/>
        </span>
        <span class="sheet-slot">
          10:<input class="sheet-contents"  type="text" name="attr_item_10_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_10_qual" value=""/>
        </span>
        <span class="sheet-slot">
          20:<input class="sheet-contents"  type="text" name="attr_item_20_desc" value=""/>
          <input class="sheet-quality" type="text" name="attr_item_20_qual" value=""/>
        </span>
          <span class="sheet-slot">
          Jewellery:<input class="sheet-contents-wide" type="text" name="attr_item_jewellery_desc" value=""/>
        </span>
    </div>
</div>


<script type="text/worker">
    const setDiceValue = (attackNum, weapon) => {
        getAttrs([`${weapon}_dice`], function(values) {
            let weaponDice = values[`${weapon}_dice`] || "d4";
            setAttrs({
                [`attack_${attackNum}_dice`]: weaponDice
            });
        });
    };

    on("change:attack_1_desc", function(eventInfo) {
        const weapon = eventInfo.newValue;
        setDiceValue(1, weapon);
    });

    on("change:attack_2_desc", function(eventInfo) {
        const weapon = eventInfo.newValue;
        setDiceValue(2, weapon);
    });

    on("change:attack_4_desc", function(eventInfo) {
        const weapon = eventInfo.newValue;
        setDiceValue(4, weapon);
    });

    on("change:attack_5_desc", function(eventInfo) {
        const weapon = eventInfo.newValue;
        setDiceValue(5, weapon);
    });
</script>
